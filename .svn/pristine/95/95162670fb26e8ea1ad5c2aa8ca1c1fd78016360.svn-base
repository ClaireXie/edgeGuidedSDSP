clc; clear; close all;
addpath('edges\');
scale=4;

inputFile='cones';
original=imread(['inputs/', inputFile, '_clean.png']);
%crop the original for downsampling
sz = size(original);
sz = sz - mod(sz, scale);
original = original(1:sz(1), 1:sz(2));

input=imresize(original,1/scale,'nearest');
input=double(input);
%img=input;
img=imresize(input,scale,'nearest');

edges = edge(img,'canny',0.1);

[edgelist, labelededgeim] = edgelink(edges, 10);
drawedgelist(edgelist, size(img), 1, 'rand', 2);

tol = 3;
seglist = lineseg(edgelist, tol);
drawedgelist(seglist, size(img), 2, 'rand', 3);